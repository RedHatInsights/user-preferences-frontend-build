{"version":3,"sources":["webpack://insights-frontend-starter-app/./src/PresentationalComponents/Email/email.scss","webpack://insights-frontend-starter-app/./src/Utilities/constants.js","webpack://insights-frontend-starter-app/./src/Utilities/functions.js","webpack://insights-frontend-starter-app/./src/PresentationalComponents/Email/Email.js","webpack://insights-frontend-starter-app/./src/PresentationalComponents/Email/email.scss?28c0","webpack://insights-frontend-starter-app/./src/config|lazy|/^\\.\\/.*$/|groupOptions: {}|namespace object"],"names":["___CSS_LOADER_EXPORT___","push","module","id","loaderField","fields","component","LOADER","booleanFunctions","getSchema","app","loaded","schema","visibilityFunctions","insights","chrome","hasLoosePermissions","permissions","getUserPermissions","userPermissions","some","item","find","permission","Object","fromEntries","keys","map","methodName","calculatePermissions","Promise","all","flat","method","args","then","visibility","every","Boolean","calculateEmailConfig","config","dispatch","entries","key","url","apiName","apiVersion","localFile","rest","isVisible","resolve","newMapper","getEmailSchema","application","reduce","acc","curr","concatApps","apps","slice","length","join","distributeSuccessError","promisses","allSettled","promise","index","value","meta","title","success","error","dispatchMessages","addNotification","dismissable","variant","useDispatch","useState","emailConfig","setEmailConfig","isLoaded","useLoaded","register","emailPreferences","store","useSelector","saveValues","unsubscribe","values","promises","filter","action","saveEmailValues","payload","PageHeader","PageHeaderTitle","Main","className","Stack","hasGutter","StackItem","YourInformation","Card","ouiaId","CardHeader","TextContent","Text","TextVariants","CardBody","componentMapper","DESCRIPTIVE_CHECKBOX","DescriptiveCheckbox","Loader","DATA_LIST","DataListLayout","FormTemplate","props","FormButtons","name","sections","storeSchema","label","Skeleton","getSection","calculateSection","onSubmit","Bullseye","Spinner","update","hot","invalidate","oldLocals","accept","a","b","isNamedExport","p","isEqualLocals","dispose","webpackAsyncContext","req","__webpack_require__","o","e","Error","code","ids","t","exports"],"mappings":"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","file":"js/Email.5c63bf903e116c5d60d5.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".email .pref-email .pref-email__subs-info{padding-bottom:0}.email .pref-email .pf-c-data-list{border:0}.email .pref-email .pf-c-data-list .pref-c-title{min-width:155px;max-width:155px}.email .pref-email .pf-c-data-list .pf-c-data-list__item:last-of-type{border:0}.email .pref-email .pf-c-data-list .pf-c-data-list__item-content.pref-u-condensed{padding-top:0;padding-bottom:0}.email .pref-email .pf-c-data-list .pf-c-data-list__item-content .pf-c-data-list__cell>*{padding-bottom:var(--pf-global--spacer--md)}.email .pref-email .pf-c-data-list .pf-c-data-list__item-content .pf-c-data-list__cell>*:last-child{padding-bottom:0}.email .pref-email .pf-c-data-list .pf-c-data-list__item-row{padding-left:0}.email .pref-email .pf-c-data-list .pref-email__info-user-email{padding-left:19px}.email .pref-email .pf-c-data-list .pref-email__info-user-email a{padding-left:var(--pf-global--gutter)}.email .pref-email .pref-u-bold{font-weight:var(--pf-global--FontWeight--bold)}.email .pref-email div.pref-u-condensed{padding-top:var(--pf-global--spacer--sm);padding-bottom:0}.email .pref-email .pref-email__form-button{margin-right:16px}@media screen and (max-width: 768px){.email .pref-email .pf-c-data-list .pref-email__info-user-email{padding-left:0}.email .pref-email .pf-c-data-list .pref-email__info-user-email.pf-c-data-list__cell span{padding-bottom:var(--pf-global--spacer--sm)}.email .pref-email .pf-c-data-list .pref-email__info-user-email>*{display:block}.email .pref-email .pf-c-data-list .pref-email__info-user-email a{padding-left:0}.email .pref-email .pref-email__info .pf-c-card__body .pf-l-flex>div:first-of-type{flex-grow:0;flex-basis:100%}.email .pref-email .pref-email__info .pf-c-card__body .pf-l-flex .pref-email_loader span{margin-left:0}.email .pref-email .pf-c-data-list__item:last-of-type .pf-c-data-list__cell:last-of-type{padding-top:var(--pf-global--spacer--lg)}.email .pref-email ul.pf-c-data-list .pf-c-data-list__item div.pf-c-data-list__cell.pref-u-condensed{padding-top:0;padding-bottom:0}}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/PresentationalComponents/Email/email.scss\"],\"names\":[],\"mappings\":\"AAAA,0CACmC,gBAAgB,CADnD,mCACgF,QAAQ,CADxF,iDACmI,eAAe,CAAC,eAAe,CADlK,sEACkO,QAAQ,CAD1O,kFACsT,aAAa,CAAC,gBAAgB,CADpV,yFACua,2CAA2C,CADld,oGACgjB,gBAAgB,CADhkB,6DACunB,cAAc,CADroB,gEAC+rB,iBAAiB,CADhtB,kEAC4wB,qCAAqC,CADjzB,gCAC20B,8CAA8C,CADz3B,wCAC25B,wCAAwC,CAAC,gBAAgB,CADp9B,4CAC0/B,iBAAiB,CAAC,qCAD5gC,gEAC0mC,cAAc,CADxnC,0FAC4sC,2CAA2C,CADvvC,kEACmzC,aAAa,CADh0C,kEAC43C,cAAc,CAD14C,mFACu9C,WAAW,CAAC,eAAe,CADl/C,yFACqkD,aAAa,CADllD,yFACqqD,wCAAwC,CAD7sD,qGAC4yD,aAAa,CAAC,gBAAgB,CAAE\",\"sourcesContent\":[\".email{\\n.pref-email .pref-email__subs-info{padding-bottom:0}.pref-email .pf-c-data-list{border:0}.pref-email .pf-c-data-list .pref-c-title{min-width:155px;max-width:155px}.pref-email .pf-c-data-list .pf-c-data-list__item:last-of-type{border:0}.pref-email .pf-c-data-list .pf-c-data-list__item-content.pref-u-condensed{padding-top:0;padding-bottom:0}.pref-email .pf-c-data-list .pf-c-data-list__item-content .pf-c-data-list__cell>*{padding-bottom:var(--pf-global--spacer--md)}.pref-email .pf-c-data-list .pf-c-data-list__item-content .pf-c-data-list__cell>*:last-child{padding-bottom:0}.pref-email .pf-c-data-list .pf-c-data-list__item-row{padding-left:0}.pref-email .pf-c-data-list .pref-email__info-user-email{padding-left:19px}.pref-email .pf-c-data-list .pref-email__info-user-email a{padding-left:var(--pf-global--gutter)}.pref-email .pref-u-bold{font-weight:var(--pf-global--FontWeight--bold)}.pref-email div.pref-u-condensed{padding-top:var(--pf-global--spacer--sm);padding-bottom:0}.pref-email .pref-email__form-button{margin-right:16px}@media screen and (max-width: 768px){.pref-email .pf-c-data-list .pref-email__info-user-email{padding-left:0}.pref-email .pf-c-data-list .pref-email__info-user-email.pf-c-data-list__cell span{padding-bottom:var(--pf-global--spacer--sm)}.pref-email .pf-c-data-list .pref-email__info-user-email>*{display:block}.pref-email .pf-c-data-list .pref-email__info-user-email a{padding-left:0}.pref-email .pref-email__info .pf-c-card__body .pf-l-flex>div:first-of-type{flex-grow:0;flex-basis:100%}.pref-email .pref-email__info .pf-c-card__body .pf-l-flex .pref-email_loader span{margin-left:0}.pref-email .pf-c-data-list__item:last-of-type .pf-c-data-list__cell:last-of-type{padding-top:var(--pf-global--spacer--lg)}.pref-email ul.pf-c-data-list .pf-c-data-list__item div.pf-c-data-list__cell.pref-u-condensed{padding-top:0;padding-bottom:0}}\\n\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import { LOADER } from '../SmartComponents/FormComponents';\n\nexport const loaderField = [{ fields: [{ component: LOADER }] }];\n","import React from 'react';\nimport { Skeleton } from '@redhat-cloud-services/frontend-components/Skeleton';\nimport { getEmailSchema } from '../actions';\nimport { loaderField } from './constants';\nimport { addNotification } from '@redhat-cloud-services/frontend-components-notifications/redux';\n\nexport const getSchema = (app) =>\n  !app || !app.loaded ? loaderField : app.schema;\n\nconst withNegatedFunction = (booleanFunctions) => {\n  return {\n    ...booleanFunctions,\n    ...Object.fromEntries(\n      Object.keys(booleanFunctions).map((methodName) => [\n        `!${methodName}`,\n        (...args) => !booleanFunctions[methodName](...args),\n      ])\n    ),\n  };\n};\n\nexport const visibilityFunctions = withNegatedFunction({\n  ...insights.chrome?.visibilityFunctions,\n  hasLoosePermissions: async (permissions = []) => {\n    const userPermissions = await insights.chrome.getUserPermissions();\n    return permissions.some((item) =>\n      userPermissions?.find(({ permission }) => permission === item)\n    );\n  },\n});\n\nexport const calculatePermissions = (permissions) =>\n  Promise.all(\n    [permissions]\n      .flat()\n      .map(({ method, args }) =>\n        visibilityFunctions?.[method]?.(...(args || []))\n      )\n  ).then((visibility) => visibility.every(Boolean));\n\nexport const calculateEmailConfig = (\n  { 'email-preference': config } = { 'email-preference': {} },\n  dispatch = () => {}\n) =>\n  Object.entries(config)\n    .map(\n      ([\n        key,\n        { permissions, url, apiName, apiVersion, localFile, ...rest },\n      ]) => {\n        const isVisible = permissions\n          ? calculatePermissions(permissions)\n          : true;\n        (async () => {\n          const schemaVisible = await Promise.resolve(isVisible);\n          if (schemaVisible) {\n            if (localFile) {\n              const newMapper = (await import(`../config/${localFile}`))\n                .default;\n              dispatch(getEmailSchema({ schema: newMapper, application: key }));\n            } else {\n              dispatch(\n                getEmailSchema({ application: key, url, apiName, apiVersion })\n              );\n            }\n          }\n        })();\n\n        return {\n          [key]: {\n            localFile,\n            isVisible,\n            url,\n            apiName,\n            apiVersion,\n            ...rest,\n          },\n        };\n      }\n    )\n    .reduce((acc, curr) => ({ ...acc, ...curr }), {});\n\nexport const getSection = (\n  key,\n  schema = {},\n  storeSchema,\n  success = () => {}\n) => {\n  if (schema.isVisible === true) {\n    return {\n      label: schema?.title,\n      name: key,\n      fields: schema?.fields || getSchema(storeSchema),\n    };\n  } else {\n    Promise.resolve(schema.isVisible).then(success);\n\n    return {\n      label: <Skeleton />,\n      name: key,\n      fields: loaderField,\n    };\n  }\n};\n\nexport const concatApps = (apps = []) => {\n  return `${apps.slice(0, apps.length - (apps.length > 1)).join(', ')}${\n    apps.length >= 2 ? ` and ${apps[apps.length - 1]}` : ''\n  }`;\n};\n\nexport const distributeSuccessError = (promisses = []) => {\n  return Promise.allSettled(promisses.map(({ promise }) => promise)).then(\n    (apps) => {\n      return apps.reduce(\n        (acc, { value }, index) => ({\n          ...acc,\n          [value ? 'success' : 'error']: [\n            ...acc[value ? 'success' : 'error'],\n            promisses[index]?.meta?.title,\n          ],\n        }),\n        { success: [], error: [] }\n      );\n    }\n  );\n};\n\nexport const dispatchMessages = (\n  dispatch = () => undefined,\n  success = [],\n  error = []\n) => {\n  if (error.length !== 0 && success.length !== 0) {\n    dispatch(\n      addNotification({\n        dismissable: false,\n        variant: 'success',\n        title: `Email preferences for ${concatApps(\n          success\n        )} successfully saved`,\n      })\n    );\n\n    dispatch(\n      addNotification({\n        dismissable: false,\n        variant: 'danger',\n        title: `Email preferences for ${concatApps(\n          error\n        )} unsuccessfully saved`,\n      })\n    );\n  }\n\n  if (error.length === 0 && success.length !== 0) {\n    dispatch(\n      addNotification({\n        dismissable: false,\n        variant: 'success',\n        title: 'Preferences successfully saved',\n      })\n    );\n  }\n\n  if (error.length !== 0 && success.length === 0) {\n    dispatch(\n      addNotification({\n        dismissable: false,\n        variant: 'danger',\n        title: 'Preferences unsuccessfully saved',\n      })\n    );\n  }\n};\n","import React, { useState } from 'react';\nimport './email.scss';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n  componentMapper,\n  FormTemplate,\n} from '@data-driven-forms/pf4-component-mapper';\nimport { Main } from '@redhat-cloud-services/frontend-components/Main';\nimport {\n  PageHeader,\n  PageHeaderTitle,\n} from '@redhat-cloud-services/frontend-components/PageHeader';\nimport {\n  Card,\n  CardBody,\n  Stack,\n  StackItem,\n  CardHeader,\n  TextContent,\n  Text,\n  TextVariants,\n  Spinner,\n  Bullseye,\n} from '@patternfly/react-core';\nimport FormRender from '@data-driven-forms/react-form-renderer/form-renderer';\nimport {\n  DESCRIPTIVE_CHECKBOX,\n  DATA_LIST,\n  LOADER,\n  DescriptiveCheckbox,\n  DataListLayout,\n  Loader,\n} from '../../SmartComponents/FormComponents';\nimport config from '../../config/config.json';\nimport { saveEmailValues } from '../../actions';\nimport {\n  calculateEmailConfig,\n  getSection,\n  distributeSuccessError,\n  dispatchMessages,\n} from '../../Utilities/functions';\nimport FormButtons from '../shared/FormButtons';\nimport YourInformation from '../shared/YourInformation';\nimport useLoaded from '../shared/useLoaded';\nimport { emailPreferences, register } from '../../store';\n\nconst Email = () => {\n  const dispatch = useDispatch();\n\n  const [emailConfig, setEmailConfig] = useState({});\n  const isLoaded = useLoaded(async () => {\n    register(emailPreferences);\n    setEmailConfig(await calculateEmailConfig(config, dispatch));\n  });\n\n  const store = useSelector(({ emailPreferences }) => emailPreferences);\n\n  const saveValues = async ({ unsubscribe, ...values }) => {\n    const promises = Object.entries(emailConfig)\n      .filter(([, { isVisible }]) => isVisible === true)\n      .map(([application, { localFile, schema, url, apiName }]) => {\n        if (\n          !localFile &&\n          !schema &&\n          store?.[application]?.schema &&\n          Object.keys(store?.[application]?.schema).length > 0\n        ) {\n          const action = saveEmailValues({ application, values, url, apiName });\n          dispatch(action);\n\n          return {\n            promise: action.payload,\n            meta: action.meta,\n          };\n        }\n      })\n      .filter(Boolean);\n\n    const { success, error } = await distributeSuccessError(promises);\n    dispatchMessages(dispatch, success, error);\n  };\n\n  const calculateSection = (key, schema) => {\n    return getSection(key, schema, store?.[key], (isVisible) => {\n      const { ...config } = emailConfig;\n      if (isVisible === false) {\n        delete config[key];\n      } else {\n        config[key] = {\n          ...config[key],\n          isVisible,\n        };\n      }\n\n      setEmailConfig(config);\n    });\n  };\n\n  return (\n    <React.Fragment>\n      <PageHeader>\n        <PageHeaderTitle title=\"Email preferences\" />\n      </PageHeader>\n      <Main className=\"pref-email\">\n        <Stack hasGutter>\n          <StackItem>\n            <YourInformation />\n          </StackItem>\n          <StackItem>\n            <Card ouiaId=\"user-pref-email-subscriptions-card\">\n              <CardHeader className=\"pf-u-pb-0\">\n                <TextContent>\n                  <Text component={TextVariants.h2}>Email subscriptions</Text>\n                  <Text component={TextVariants.p}>\n                    Select the cloud.redhat.com emails you want to receive.\n                  </Text>\n                </TextContent>\n              </CardHeader>\n              <CardBody className=\"pref-email_form\">\n                {isLoaded ? (\n                  <FormRender\n                    componentMapper={{\n                      ...componentMapper,\n                      [DESCRIPTIVE_CHECKBOX]: DescriptiveCheckbox,\n                      [LOADER]: Loader,\n                      [DATA_LIST]: DataListLayout,\n                    }}\n                    FormTemplate={(props) => (\n                      <FormTemplate {...props} FormButtons={FormButtons} />\n                    )}\n                    schema={{\n                      fields: [\n                        {\n                          name: 'email-preferences',\n                          component: DATA_LIST,\n                          sections: Object.entries(\n                            emailConfig\n                          ).map(([key, schema]) =>\n                            calculateSection(key, schema)\n                          ),\n                        },\n                      ],\n                    }}\n                    onSubmit={saveValues}\n                  />\n                ) : (\n                  <Bullseye>\n                    <Spinner />\n                  </Bullseye>\n                )}\n              </CardBody>\n            </Card>\n          </StackItem>\n        </Stack>\n      </Main>\n    </React.Fragment>\n  );\n};\n\nexport default Email;\n","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./email.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\nif (module.hot) {\n  if (!content.locals || module.hot.invalidate) {\n    var isEqualLocals = function isEqualLocals(a, b, isNamedExport) {\n  if (!a && b || a && !b) {\n    return false;\n  }\n\n  var p;\n\n  for (p in a) {\n    if (isNamedExport && p === 'default') {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (a[p] !== b[p]) {\n      return false;\n    }\n  }\n\n  for (p in b) {\n    if (isNamedExport && p === 'default') {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (!a[p]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n    var oldLocals = content.locals;\n\n    module.hot.accept(\n      \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./email.scss\",\n      function () {\n        if (!isEqualLocals(oldLocals, content.locals, undefined)) {\n                module.hot.invalidate();\n\n                return;\n              }\n\n              oldLocals = content.locals;\n\n              update(content);\n      }\n    )\n  }\n\n  module.hot.dispose(function() {\n    update();\n  });\n}\n\nexport default content.locals || {};","var map = {\n\t\"./config.json\": [\n\t\t54084\n\t],\n\t\"./data/general.json\": [\n\t\t11636,\n\t\t636\n\t],\n\t\"./data/unsubscribe.json\": [\n\t\t58132,\n\t\t132\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(() => {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = () => (Object.keys(map));\nwebpackAsyncContext.id = 40118;\nmodule.exports = webpackAsyncContext;"],"sourceRoot":""}