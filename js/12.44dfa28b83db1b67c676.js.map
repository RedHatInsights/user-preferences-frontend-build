{"version":3,"sources":["webpack:///./src/Utilities/functions.test.js"],"names":["describe","it","loader","getSchema","expect","toMatchObject","loaderField","loaded","schema","fields","section","getSection","isVisible","name","title","label","wrapper","mount","toJson","toMatchSnapshot","done","success","jest","fn","setTimeout","toHaveBeenCalled","a","calculatePermissions","method","toBe","args","calculateEmailConfig","result","mock","onGet","reply","test","permissions","dispatch","setImmediate","calls","meta","appName","localFile","payload","apps","concatApps","promiseError","promiseSuccess","promise","Promise","resolve","reject","e","distributeSuccessError","error","length","dispatchMessages","not","dismissable","variant"],"mappings":"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","file":"js/12.44dfa28b83db1b67c676.js","sourcesContent":["import { mount } from 'enzyme';\nimport toJson from 'enzyme-to-json';\nimport {\n  getSchema,\n  getSection,\n  calculatePermissions,\n  calculateEmailConfig,\n  concatApps,\n  distributeSuccessError,\n  dispatchMessages,\n} from './functions';\nimport { loaderField } from './constants';\nimport { mock } from '../__mock__/schemaLoader';\n\ndescribe('getSchema', () => {\n  it('should return loader', () => {\n    const loader = getSchema();\n    expect(loader).toMatchObject(loaderField);\n  });\n\n  it('should return loader if not loaded', () => {\n    const loader = getSchema({ loaded: false });\n    expect(loader).toMatchObject(loaderField);\n  });\n\n  it('should return schema', () => {\n    const schema = { fields: [] };\n    const loaded = getSchema({ loaded: true, schema });\n    expect(loaded).toMatchObject(schema);\n  });\n});\n\ndescribe('getSection', () => {\n  it('should return visible schema', () => {\n    const section = getSection('first', { isVisible: true });\n    expect(section).toMatchObject({ name: 'first', fields: loaderField });\n  });\n\n  it('should return visible schema from store', () => {\n    const schema = { fields: [] };\n    const section = getSection(\n      'first',\n      { isVisible: true, title: 'Some title' },\n      { loaded: true, schema }\n    );\n    expect(section).toMatchObject({\n      label: 'Some title',\n      name: 'first',\n      fields: schema,\n    });\n  });\n\n  it('should return loader', () => {\n    const section = getSection();\n    const wrapper = mount(section.label);\n    expect(toJson(wrapper)).toMatchSnapshot();\n    expect(section).toMatchObject({ fields: loaderField });\n  });\n\n  it('should call success function', (done) => {\n    const success = jest.fn();\n    const section = getSection('first', { isVisible: false }, {}, success);\n    expect(section).toMatchObject({\n      name: 'first',\n      fields: loaderField,\n    });\n    setTimeout(() => {\n      expect(success).toHaveBeenCalled();\n      done();\n    });\n  });\n});\n\ndescribe('calculatePermissions', () => {\n  it('should check visibility of one function', async () => {\n    const isVisible = await calculatePermissions({\n      method: 'something',\n    });\n    expect(isVisible).toBe(false);\n  });\n\n  it('should check visibility of array of functions', async () => {\n    const isVisible = await calculatePermissions([\n      {\n        method: 'something',\n      },\n      {\n        method: 'something',\n        args: [true],\n      },\n    ]);\n    expect(isVisible).toBe(false);\n  });\n\n  it('should calculate visible for one function', async () => {\n    const isVisible = await calculatePermissions([\n      {\n        method: 'something',\n        args: [true],\n      },\n    ]);\n    expect(isVisible).toBe(true);\n  });\n});\n\ndescribe('calculateEmailConfig', () => {\n  it('should not throw error', async () => {\n    const result = await calculateEmailConfig();\n    expect(result).toMatchObject({});\n  });\n\n  it('should calculate schema with permissions - false', async () => {\n    mock.onGet('/api*').reply(200, {});\n    const result = calculateEmailConfig({\n      'email-preference': {\n        test: {\n          permissions: { method: 'something' },\n        },\n      },\n    });\n    expect(await result.test.isVisible).toBe(false);\n  });\n\n  it('should calculate schema with permissions - true', async () => {\n    mock.onGet('/api/test/v1/user-config/email-preference').reply(200, {});\n    const result = calculateEmailConfig({\n      'email-preference': {\n        test: {\n          permissions: { method: 'something', args: [true] },\n        },\n      },\n    });\n    expect(await result.test.isVisible).toBe(true);\n  });\n\n  it('should request localFile', (done) => {\n    mock.onGet('/api/test/v1/user-config/email-preference').reply(200, {});\n    const dispatch = jest.fn();\n    calculateEmailConfig(\n      {\n        'email-preference': {\n          test: {},\n        },\n      },\n      dispatch\n    );\n    setImmediate(() => {\n      expect(dispatch).toHaveBeenCalled();\n      expect(dispatch.mock.calls[0][0]).toMatchObject({\n        meta: {\n          appName: 'test',\n        },\n      });\n      done();\n    });\n  });\n\n  it('should request localFile', (done) => {\n    const dispatch = jest.fn();\n    calculateEmailConfig(\n      {\n        'email-preference': {\n          test: {\n            localFile: 'data/general.json',\n          },\n        },\n      },\n      dispatch\n    );\n    setImmediate(() => {\n      expect(dispatch).toHaveBeenCalled();\n      expect(dispatch.mock.calls[0][0]).toMatchObject({\n        payload: {},\n        meta: {\n          appName: 'test',\n        },\n      });\n      done();\n    });\n  });\n});\n\ndescribe('concatApps', () => {\n  it('should concat no app', () => {\n    const apps = concatApps();\n    expect(apps).toBe('');\n  });\n\n  it('should concat one app', () => {\n    const apps = concatApps(['one']);\n    expect(apps).toBe('one');\n  });\n\n  it('should concat two apps', () => {\n    const apps = concatApps(['one', 'two']);\n    expect(apps).toBe('one and two');\n  });\n\n  it('should concat multiple apps', () => {\n    const apps = concatApps(['one', 'two', 'three']);\n    expect(apps).toBe('one, two and three');\n  });\n});\n\ndescribe('distributeSuccessError', () => {\n  const promiseSuccess = { promise: Promise.resolve(3) };\n  let promiseError;\n  try {\n    promiseError = {\n      promise: new Promise((resolve, reject) => setTimeout(reject, 100, 'foo')),\n    };\n  } catch (e) {\n    (() => {})();\n  }\n\n  it('should not fail with empty', async () => {\n    const { success, error } = await distributeSuccessError();\n    expect(success.length).toBe(0);\n    expect(error.length).toBe(0);\n  });\n\n  it('should not fail with false', async () => {\n    const { success, error } = await distributeSuccessError([false]);\n    expect(success.length).toBe(0);\n    expect(error.length).toBe(1);\n  });\n\n  it('should have one success and error', async () => {\n    const { success, error } = await distributeSuccessError([\n      promiseSuccess,\n      promiseError,\n    ]);\n    expect(success.length).toBe(1);\n    expect(error.length).toBe(1);\n  });\n\n  it('should have 2 successes and no error', async () => {\n    const { success, error } = await distributeSuccessError([\n      promiseSuccess,\n      promiseSuccess,\n    ]);\n    expect(success.length).toBe(2);\n    expect(error.length).toBe(0);\n  });\n\n  it('should have 2 errors and no success', async () => {\n    const { success, error } = await distributeSuccessError([\n      promiseError,\n      promiseError,\n    ]);\n    expect(success.length).toBe(0);\n    expect(error.length).toBe(2);\n  });\n});\n\ndescribe('dispatchMessages', () => {\n  it('should not fail with no messages', () => {\n    const dispatch = jest.fn();\n    dispatchMessages();\n    expect(dispatch).not.toHaveBeenCalled();\n  });\n\n  it('should not fail with no messages', () => {\n    const dispatch = jest.fn();\n    dispatchMessages(dispatch);\n    expect(dispatch).not.toHaveBeenCalled();\n  });\n\n  it('should dispatch one success', () => {\n    const dispatch = jest.fn();\n    dispatchMessages(dispatch, ['some', 'message', 'multiple']);\n    expect(dispatch).toHaveBeenCalled();\n    expect(dispatch.mock.calls[0][0]).toMatchObject({\n      payload: {\n        dismissable: false,\n        title: 'Preferences successfully saved',\n        variant: 'success',\n      },\n    });\n  });\n\n  it('should dispatch one danger', () => {\n    const dispatch = jest.fn();\n    dispatchMessages(dispatch, [], ['some', 'message', 'multiple']);\n    expect(dispatch).toHaveBeenCalled();\n    expect(dispatch.mock.calls[0][0]).toMatchObject({\n      payload: {\n        dismissable: false,\n        title: 'Preferences unsuccessfully saved',\n        variant: 'danger',\n      },\n    });\n  });\n\n  it('should dispatch one danger and one error', () => {\n    const dispatch = jest.fn();\n    dispatchMessages(\n      dispatch,\n      ['some', 'message', 'multiple'],\n      ['some', 'message', 'multiple']\n    );\n    expect(dispatch).toHaveBeenCalled();\n    expect(dispatch.mock.calls[0][0]).toMatchObject({\n      payload: {\n        dismissable: false,\n        title:\n          'Email preferences for some, message and multiple successfully saved',\n        variant: 'success',\n      },\n    });\n    expect(dispatch.mock.calls[1][0]).toMatchObject({\n      payload: {\n        dismissable: false,\n        title:\n          'Email preferences for some, message and multiple unsuccessfully saved',\n        variant: 'danger',\n      },\n    });\n  });\n});\n"],"sourceRoot":""}