(self.webpackChunkuser_preferences_frontend=self.webpackChunkuser_preferences_frontend||[]).push([[8],{12299:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Qe});var r=n(15861),i=n(4942),a=n(29439),c=n(64687),o=n.n(c),s=n(92950),l=n.n(s),u=n(57557),p=n.n(u),f=n(55140),d=n(46118),m=n(374),v=n(89117),b=n(39173),y=n(83215),h=n(54025),g=n(28216),O=n(33366);O.ZP.interceptors.response.use((function(e){var t;if(null!=e&&null!==(t=e.config)&&void 0!==t&&t.data)try{return JSON.parse(e.config.data)}catch(t){return e.config.data}return e}));var E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"v1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0;return O.ZP.get("/api/".concat(e,"/").concat(t).concat(r||"/user-config/".concat(n)))},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"v1";return O.ZP.get("/api/notifications/".concat(e,"/user-config/notification-event-type-preference"))},P=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r,i,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:"v1",i=a.length>3?a[3]:void 0,e.abrupt("return",O.ZP.post("/api/".concat(t,"/").concat(r).concat(i||"/user-config/notification-event-type-preference"),n));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=n(36580),Z=function(e){return{type:w.aI.GET_NOTIFICATIONS_SCHEMA,payload:j(e),meta:{notifications:{rejected:{variant:"danger",title:"Request for user's configuration failed",description:"User's configuration notification for this bundle does not exist."}}}}},S=function(e,t){return{type:w.aI.SAVE_NOTIFICATION_SCHEMA,payload:P("notifications",e,t)}},k=function(e){var t=e.application,n=e.apiVersion,r=e.resourceType,i=void 0===r?"email-preference":r,a=e.schema,c=e.url,o=e.apiName;return{type:w.aI.GET_EMAIL_SCHEMA,payload:a||E(o||t,n,i,c),meta:{appName:t,notifications:{rejected:{variant:"danger",title:"Request for user's configuration failed",description:"User's configuration email for ".concat(null==t?void 0:t.label," application does not exist.")}}}}},C=n(45987),N=n(93433),D=n(87462),F=n(45697),T=n.n(F),x=n(41693),R=n(48880),I=n(74041),L=["onChange","checked"];function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t=(0,x.Z)(B(B({},e),{},{type:"checkbox"})),n=t.label,r=t.title,i=t.description,a=t.checkedWarning,c=t.infoMessage,o=t.afterChange,s=t.disabled,u=t.input,p=u.onChange,f=u.checked,d=(0,C.Z)(u,L),m=(0,R.default)();return l().createElement(v.Checkbox,(0,D.Z)({},d,{isChecked:f,isDisabled:s,id:"descriptive-checkbox-".concat(d.name),onChange:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];p.apply(void 0,[e,t].concat(r)),null==o||o(m,e)},"data-type":"descriptive-checkbox",className:"pref-c-descriptive-checkbox",label:n||r,description:l().createElement("div",null,i&&l().createElement(l().Fragment,null,l().createElement("span",{className:"pref-c-checkbox-description"},i)),!f&&c&&l().createElement("span",{className:"pref-c-checkbox-info"},l().createElement(I.InfoCircleIcon,null)," ",c),f&&a&&l().createElement("span",{className:"pref-c-checkbox-warning"},l().createElement(I.ExclamationTriangleIcon,null)," ",a))}))};M.propTypes={FieldProvider:T().any,formOptions:T().any,group:T().string,section:T().string,name:T().string,label:T().string,title:T().string,description:T().string,afterChange:T().func},M.defaultProps={name:"",label:""};const A=M;var V=n(35664),U=["name","size","FieldProvider","validate","FormSpyProvider","formOptions"],z=function(e){e.name;var t=e.size,n=(e.FieldProvider,e.validate,e.FormSpyProvider,e.formOptions,(0,C.Z)(e,U));return l().createElement("div",n,l().createElement(V.Z,{size:t}))};z.propTypes={FieldProvider:T().any,formOptions:T().any,FormSpyProvider:T().any,validate:T().any,name:T().string,size:T().string},z.defaultProps={name:"",size:"md"};const G=z;var H=n(15671),q=n(43144),K=n(97326),Q=n(60136),X=n(82963),W=n(61120);var Y=function(e){(0,Q.Z)(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,W.Z)(t);if(n){var i=(0,W.Z)(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return(0,X.Z)(this,e)});function a(){var e;(0,H.Z)(this,a);for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return e=r.call.apply(r,[this].concat(n)),(0,i.Z)((0,K.Z)(e),"state",{hasError:!1}),e}return(0,q.Z)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:t})}},{key:"render",value:function(){var e=this.props,t=e.fieldsKey,n=e.label,r=e.fields,i=e.formOptions,a=this.state.hasError;return l().createElement(v.DataListItemRow,null,l().createElement(v.DataListItemCells,{dataListCells:[l().createElement(v.DataListCell,{isFilled:!1,className:"pref-c-title pref-u-bold",key:"".concat(t,"-title")},0===t?n:""),l().createElement(v.DataListCell,{isFilled:!0,key:"".concat(t,"-content")},a?"Error while mapping fields, please check your schema if it has valid component types":null==i?void 0:i.renderForm(r,i))]}))}}]),a}(s.Component);Y.propTypes={fieldsKey:T().oneOfType([T().string,T().number]),fields:T().array,FieldProvider:T().any,formOptions:T().any,label:T().node,name:T().string,validate:T().any,FormSpyProvider:T().any};var J=function(e){var t=(0,x.Z)(e),n=t.sections,r=t.label,i=t.name,a=(0,R.default)();return l().createElement(v.DataList,(0,D.Z)({"aria-label":r||i},e),n.map((function(e,t){var n=e.label,r=e.fields,c=Array.isArray(r)?r:[r];return c.length>0&&l().createElement(v.DataListItem,{name:i,key:t,"aria-labelledby":"simple-item1"},c.map((function(e,r){var i=e.fields;return l().createElement(Y,{key:"".concat(t,"-").concat(r),fieldsKey:r,label:n,fields:i,formOptions:a})})))})))};J.propTypes={sections:T().array,FieldProvider:T().any,formOptions:T().any,label:T().node,name:T().string,validate:T().any,FormSpyProvider:T().any};const $=J;function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=function(e){var t=(0,R.default)(),n=(0,x.Z)(te(te({},e),{},{type:"button"})),r=n.input,i=n.section,a=n.onClick;return l().createElement(v.Button,(0,D.Z)({className:"pref-c-bulk-select-button",variant:"secondary"},r,{id:"bulk-select-".concat(i),onClick:function(){return null==a?void 0:a(t,r)}}),r.value?"Select":"Deselect"," all")};ne.propTypes={section:T().string,onClick:T().func};const re=ne;var ie=function(e){var t=e.fields,n=e.label,r=e.level,i=e.description,a=(0,d.XQ)();return l().createElement(v.FormGroup,{className:"pref-c-input-".concat(1===r?"category":"group"),label:n},i?l().createElement(v.Text,{className:"pf-u-pb-md"},i):null,a.renderForm(t,a))};ie.propTypes={fields:T().array.isRequired,label:T().string,level:T().number,description:T().string};const ae=ie;var ce,oe="BULK_SELECT_BUTTON",se="inputGroup",le="tabs",ue="tabGroup",pe=["permissions","url","apiName","apiVersion","localFile"];function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me,ve,be=(me=de(de({},null===(ce=insights.chrome)||void 0===ce?void 0:ce.visibilityFunctions),{},{hasLoosePermissions:(ve=(0,r.Z)(o().mark((function e(){var t,n,r=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],e.next=3,insights.chrome.getUserPermissions();case 3:return n=e.sent,e.abrupt("return",t.some((function(e){return null==n?void 0:n.find((function(t){return t.permission===e}))})));case 5:case"end":return e.stop()}}),e)}))),function(){return ve.apply(this,arguments)})}),de(de({},me),Object.fromEntries(Object.keys(me).map((function(e){return["!".concat(e),function(){return!me[e].apply(me,arguments)}]}))))),ye=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{"email-preference":{}})["email-preference"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return Object.entries(e).map((function(e){var c=(0,a.Z)(e,2),s=c[0],l=c[1],u=l.permissions,p=l.url,f=l.apiName,d=l.apiVersion,m=l.localFile,v=(0,C.Z)(l,pe),b=!u||function(e){return Promise.all([e].flat().map((function(e){var t,n=e.method,r=e.args;return null==be||null===(t=be[n])||void 0===t?void 0:t.call.apply(t,[be].concat((0,N.Z)(r||[])))}))).then((function(e){return e.every(Boolean)}))}(u);return(0,r.Z)(o().mark((function e(){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve(b);case 2:if(!e.sent){e.next=12;break}if(!m){e.next=11;break}return e.next=7,n(40118)("./".concat(m));case 7:r=e.sent.default,t(k({schema:r,application:s})),e.next=12;break;case 11:t(k({application:s,url:p,apiName:f,apiVersion:d}));case 12:case"end":return e.stop()}}),e)})))(),(0,i.Z)({},s,de({localFile:m,isVisible:b,url:p,apiName:f,apiVersion:d},v))})).reduce((function(e,t){return de(de({},e),t)}),{})},he=n(25091),ge=n(57703),Oe=n(66688);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=function(e,t,n,r){var i=new URLSearchParams(null==e?void 0:e.search),a=Object.fromEntries(i);return n.some((function(e){return e.name===a.bundle&&e.fields.some((function(e){return e.name===a.app}))}))?a:(r.bundle&&r.app&&(i.set("bundle",r.bundle),i.set("app",r.app),t({pathname:e.pathname,search:i.toString()},{replace:!0})),je(je({},a),r))},we=function(e){var t=e.searchRef,n=e.search,r=e.setSearch,i=e.fields,a=e.onClick,c=(0,ge.useLocation)(),o=(0,ge.useNavigate)(),u=(0,s.useMemo)((function(){return Pe(c,o,i,{})}),[c.search]),p=u.bundle,f=u.app;return l().createElement(v.Menu,{isPlain:!0,isScrollable:!0},l().createElement(v.MenuInput,{ref:t,className:"pf-u-mx-sm"},l().createElement(v.TextInput,{"aria-label":"Filter menu items",placeholder:"Search services",iconVariant:"search",type:"search",onChange:function(e){return r(e)},value:n})),l().createElement(v.Divider,null),l().createElement(v.MenuContent,{id:"notifications-menu-content"},i.some((function(e){return e.fields.length>0}))?i.map((function(e){var t=e.fields,n=e.title,r=e.name;return t.length>0?l().createElement(v.MenuGroup,{label:n,className:"pf-u-px-sm",key:"menu-group-".concat(r)},l().createElement(v.MenuList,null,t.map((function(e){var t=e.label,n=e.name;return l().createElement(v.MenuItem,{onClick:function(e){return a(e,r,n)},key:"menu-item-".concat(r,"-").concat(n),isFocused:p===r&&f===n},t)})))):null})):function(e){return l().createElement(v.EmptyState,{variant:v.EmptyStateVariant.small,className:"pf-u-mt-lg"},l().createElement(v.EmptyStateIcon,{icon:I.SearchIcon}),l().createElement(v.Title,{headingLevel:"h4",size:"lg"},"No matching services found"),l().createElement(v.EmptyStateBody,null,"Adjust your filters and try again."),l().createElement(v.Button,{variant:v.ButtonVariant.link,onClick:function(){return e("")}},"Clear filters"))}(r)))};we.propTypes={fields:T().array.isRequired,search:T().string,setSearch:T().func,searchRef:T().object,onClick:T().func};const Ze=we;function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=function(e){var t,n,r,i,c,o=e.fields,u=e.titleRef,p=e.bundles,f=(0,ge.useLocation)(),m=(0,ge.useNavigate)(),b=(0,d.XQ)(),y=(0,s.useRef)(null),h=(0,s.useRef)({}),g=(0,s.useState)(""),O=(0,a.Z)(g,2),E=O[0],j=O[1],P=(0,s.useState)(o),w=(0,a.Z)(P,2),Z=w[0],S=w[1],k=(0,Oe.cl)(),C=k.pristine,D=k.submitSucceeded,F=k.dirtyFieldsSinceLastSubmit,T=function(){var e=document.getElementById("notifications-container"),t=document.getElementById("notifications-grid"),n=document.getElementById("notifications-menu-content");if(null!=n&&n.style&&null!=t&&t.style){var r,i,a=(null===(r=document.getElementById("user-pref__form-buttons"))||void 0===r||null===(i=r.getBoundingClientRect())||void 0===i?void 0:i.height)||0;t.style.height="".concat(e.getBoundingClientRect().height-a,"px");var c=e.getBoundingClientRect().height-u.current.getBoundingClientRect().height-y.current.getBoundingClientRect().height-(c<n.scrollHeight?a:0)-1;n.style.maxHeight="".concat(c,"px"),n.style.height="".concat(c-a,"px")}};return(0,s.useEffect)((function(){var e,t,n,r;return window.screen.width>768&&(window.addEventListener("resize",T),T()),h.current=Pe(f,m,o,{bundle:null==o||null===(e=o[0])||void 0===e?void 0:e.name,app:null==o||null===(t=o[0])||void 0===t||null===(n=t.fields)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.name}),function(){return window.removeEventListener("resize",T)}}),[]),(0,s.useEffect)((function(){var e=o.reduce((function(e,t){return[].concat((0,N.Z)(e),[ke(ke({},t),{},{fields:t.fields.filter((function(e){var t,n,r=E.toLowerCase();return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r))||(null===(n=e.title)||void 0===n?void 0:n.toLowerCase().includes(r))}),[])})])}),[]);S(e)}),[E]),(0,s.useEffect)((function(){T()}),[C,D,F]),l().createElement(l().Fragment,null,l().createElement("div",{className:"pref-notifications--nav"},l().createElement(Ze,{searchRef:y,search:E,setSearch:j,fields:Z,onClick:function(e,t,n){e.preventDefault(),h.current={bundle:t,app:n},function(e,t,n){var r=new URLSearchParams(null==e?void 0:e.search);Object.entries(n).forEach((function(e){var t=(0,a.Z)(e,2),n=t[0],i=t[1];r.set(n,i)})),t({pathname:e.pathname,search:r.toString()},{replace:!0})}(f,m,h.current)}})),l().createElement("div",{className:"pref-notifications--inputs"},l().createElement(l().Fragment,null,(i=null===(t=p[h.current.bundle])||void 0===t?void 0:t.label,c=null===(n=o.reduce((function(e,t){return[].concat((0,N.Z)(e),(0,N.Z)(t.fields))}),[]).filter((function(e){return e.name===h.current.app&&e.bundle===h.current.bundle})))||void 0===n||null===(r=n[0])||void 0===r?void 0:r.label,l().createElement(l().Fragment,null,l().createElement(v.Title,{headingLevel:"h3",size:"xl",className:"pf-u-pb-xs"},"".concat(c," | ").concat(i)),l().createElement(v.Text,{className:"pf-u-mb-md"},"Configure your ",c," notifications."))),l().createElement("div",null,b.renderForm(o.reduce((function(e,t){return[].concat((0,N.Z)(e),(0,N.Z)(t.fields.map((function(e){return ke(ke({},e),{},{key:"form-".concat(e.bundle,"-").concat(e.name),fields:[e.fields.map((function(t){return ke(ke({},t),{},{hideField:!(e.name===h.current.app&&e.bundle===h.current.bundle)})}))]})}))))}),[]),b)))))};Ce.propTypes={fields:T().array.isRequired,titleRef:T().any,bundles:T().shape({label:T().string})};const Ne=l().memo(Ce);var De=function(e){var t=e.fields,n=(0,d.XQ)();return l().createElement("div",{className:"pf-c-form"},n.renderForm(t,n))};De.propTypes={fields:T().array.isRequired};const Fe=De;function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e,t,n,r){var i,c,o;t?Object.entries((null===(i=e.getState().values.bundles)||void 0===i||null===(c=i[n])||void 0===c||null===(o=c.applications)||void 0===o?void 0:o[r].eventTypes)||{}).every((function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1];return n===oe||r}))&&("rhel"!==n&&"advisor"!==r||e.getState().values.is_subscribed)&&e.change("bundles[".concat(n,"].applications[").concat(r,"].eventTypes[").concat(oe,"]"),!1):e.change("bundles[".concat(n,"].applications[").concat(r,"].eventTypes[").concat(oe,"]"),!0)},Ie=function(e,t,n){return Object.entries(e).reduce((function(e,r){var i=(0,a.Z)(r,2),c=i[0],o=i[1];return[].concat((0,N.Z)(e),[{title:null==o?void 0:o.label,name:c,fields:Object.entries(o.applications).reduce((function(e,r){var i=(0,a.Z)(r,2),o=i[0],s=i[1],l=!0,u=[].concat((0,N.Z)(Object.entries(t).reduce((function(e,t){var r,i,a;return[].concat((0,N.Z)(e),(0,N.Z)(t[0]===o&&(null===(r=n[t[0]])||void 0===r?void 0:r.bundle)===c?[{label:"Reports",name:"email-reports",component:se,level:1,fields:null===(i=t[1].schema[0])||void 0===i||null===(a=i.fields)||void 0===a?void 0:a.map((function(e){return l=l&&e.initialValue,xe(xe({},p()(e,["infoMessage","checkedWarning"])),{},{afterChange:function(e,t){return Re(e,t,c,o)}})}))}]||0:[]))}),[])),[{label:"Event notifications",description:"Select how would you like to receive notifications for each event.",name:"event-notifications",component:se,level:1,fields:(0,N.Z)(s.eventTypes.map((function(e,t){return{label:e.label,name:"".concat(e.name,"-").concat(t),component:se,fields:e.fields.map((function(e){return l=l&&e.initialValue,xe(xe({},p()(e,["description","infoMessage","checkedWarning"])),{},{afterChange:function(e,t){return Re(e,t,c,o)}})}))}})))}]);return[].concat((0,N.Z)(e),[{name:o,bundle:c,label:s.label,component:ue,fields:[{name:"bundles[".concat(c,"].applications[").concat(o,"].eventTypes[").concat(oe,"]"),section:o,initialValue:!l,component:oe,onClick:function(e,t){e.batch((function(){e.getRegisteredFields().forEach((function(n){(n.includes(c)&&n.includes(o)||"is_subscribed"===n&&"rhel"===c&&"advisor"==o)&&!n.includes(oe)&&e.change(n,t.value)}))})),t.onChange(!t.value)}}].concat((0,N.Z)(u))}])}),[])}])}),[])},Le=n(55218),_e=n(41609),Be=n.n(_e),Me=function(e){var t=e.dirtyFieldsSinceLastSubmit,n=e.submitSucceeded,r=e.pristine,i=(0,R.default)().reset,a=Be()(t)||!n&&r;return a?null:l().createElement("div",{id:"user-pref__form-buttons",className:"pref-shared--buttons pf-m-9-col-on-md"},l().createElement(v.ActionGroup,{className:"pref-shared--actions pf-u-px-lg pf-u-py-md"},l().createElement(v.Button,{type:"submit",ouiaId:"user-pref__submit-button",isDisabled:a,variant:"primary"},"Save"),l().createElement(v.Button,{variant:"link",ouiaId:"user-pref__reset-button",isDisabled:a,onClick:function(){return i()}},"Cancel")))};Me.propTypes={dirtyFieldsSinceLastSubmit:T().shape((0,i.Z)({},T().string,T().oneOfType([T().bool]))),submitSucceeded:T().bool,pristine:T().bool};const Ae=function(e){return l().createElement(d.lP,{subscription:{pristine:!0,submitSucceeded:!0,dirtyFieldsSinceLastSubmit:!0}},(function(t){return l().createElement(Me,(0,D.Z)({},t,e))}))};var Ve=n(30273);function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ge=function(e){var t=e.schema,n=e.formFields,r=(0,d.XQ)(),i=(0,s.useState)(!1),c=(0,a.Z)(i,2),o=c[0],u=c[1],p=(0,f.Z)().chromeHistory,m=(0,s.useState)({confirmed:!1,pathname:"",search:""}),v=(0,a.Z)(m,2),b=v[0],y=v[1],h=(0,s.useCallback)((function(e,t){return t.length>0?p.push({pathname:e,search:t}):p.push(e)}),[p]);return(0,s.useEffect)((function(){var e=!r.getState().dirty||b.confirmed||b.search.length>0;e&&h(b.pathname,b.search);var t=p.block((function(t){var n,i,a,c=t.location;return!r.getState().dirty||0!==(null===(n=c.search)||void 0===n?void 0:n.length)||null!==(i=c.pathname)&&void 0!==i&&i.includes(Ve.Z.notifications.link)&&null!==(a=c.pathname)&&void 0!==a&&a.includes("user-preferences")||u(!0),y((function(e){return ze(ze({},e),{},{pathname:c.pathname,search:c.search})})),e}));return function(){t()}}),[b.confirmed,b.pathname,b.search]),l().createElement(l().Fragment,null,l().createElement(Le.Z,{isOpen:o,title:"Unsaved changes",onConfirm:function(){y((function(e){return ze(ze({},e),{},{confirmed:!0})})),u(!1)},onClose:function(){return u(!1)}},"Your page contains unsaved changes. Do you want to leave?"),l().createElement("form",{onSubmit:r.handleSubmit,style:{display:"contents"}},t.title,n,l().createElement(Ae,null)))};Ge.propTypes={schema:T().shape({title:T().node}),formFields:T().array};const He=Ge;function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Qe=function(){var e,t=(0,f.Z)().auth,n=(0,g.I0)(),c=(0,s.useRef)(null),u=(0,s.useState)({}),O=(0,a.Z)(u,2),E=O[0],j=O[1],k=(0,g.oR)(),C=(0,g.v9)((function(e){return e.emailReducer})),N=(0,g.v9)((function(e){var t,n=e.notificationsReducer;return Ke(Ke({},n),{},{bundles:null===(t=Object.entries((null==n?void 0:n.bundles)||{}))||void 0===t?void 0:t.reduce((function(e,t){var n=(0,a.Z)(t,2),r=n[0],c=n[1];return Ke(Ke({},e),he["notification-preference"].includes(r)?(0,i.Z)({},r,c):{})}),{})})})),D=N.bundles,F=N.loaded;return(0,s.useEffect)((function(){(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getUser();case 2:j(ye(he,n)),n(Z());case 4:case"end":return e.stop()}}),e)})))()}),[]),F&&Object.values(C).every((function(e){return e.loaded}))?l().createElement("div",{id:"notifications-container",className:"pref-notifications--container"},l().createElement("div",{className:"pref-notifications--wrapper"},l().createElement("div",{id:"notifications-grid",className:"pref-notifications--grid"},l().createElement("div",{ref:c,className:"pref-notifications--head"},l().createElement(b.Z,{className:"pref-notifications--title sticky",title:"My Notifications"}),l().createElement(v.Text,{className:"pref-notifications--subtitle"},"Opt in or out of receiving notifications, and choose how you want to be notified. Your Organization Administrator has configured which notifications you can or can’t receive in their"," ",l().createElement("a",{href:"/settings/notifications"},"Settings"),".",l().createElement(h.ScalprumComponent,{module:"./ConnectedTimeConfig",scope:"notifications",store:k}))),l().createElement(d.lT,{componentMapper:Ke(Ke({},m.YS),{},(e={},(0,i.Z)(e,"descriptiveCheckbox",A),(0,i.Z)(e,oe,re),(0,i.Z)(e,"loader",G),(0,i.Z)(e,"section",$),(0,i.Z)(e,se,ae),(0,i.Z)(e,le,Ne),(0,i.Z)(e,ue,Fe),e)),FormTemplate:He,schema:{fields:[{component:le,name:"notifTabs",titleRef:c,bundles:D,fields:Ie(D,C,E)}]},onSubmit:function(e,t){var r={bundles:Object.entries(e.bundles).reduce((function(e,t){var n=(0,a.Z)(t,2),r=n[0],c=n[1];return Ke(Ke({},e),{},(0,i.Z)({},r,{applications:Object.entries(c.applications).reduce((function(e,t){var n=(0,a.Z)(t,2),r=n[0],c=n[1];return Ke(Ke({},e),{},(0,i.Z)({},r,{eventTypes:p()(c.eventTypes,oe)}))}),{})}))}),{})},c=[n(S(r))],o=t.getState().dirtyFields.is_subscribed;if(o){var s=E.advisor,l=s.url,u=s.apiName,f=function(e){var t=e.application,n=e.values,r=e.apiVersion,i=e.url,a=e.apiName;return{type:w.aI.SAVE_EMAIL_SCHEMA,payload:P(a||t,n,r,i),meta:{appName:t,title:null==t?void 0:t.label}}}({application:"advisor",values:{is_subscribed:e.is_subscribed},url:l,apiName:u});c.push(n(f))}Promise.all(c).then((function(){o&&j(ye(he,n)),n(Z()),n((0,y.wN)({dismissable:!0,variant:"success",title:"Notification preferences successfully saved"}))})).catch((function(){n((0,y.wN)({dismissable:!0,variant:"danger",title:"Notification preferences unsuccessfully saved"}))}))}})))):l().createElement(v.Bullseye,null,l().createElement(v.Spinner,null))}},40118:(e,t,n)=>{var r={"./config.json":[25091],"./data/general.json":[14298,298],"./data/unsubscribe.json":[17814,814]};function i(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n.t(i,19)))}i.keys=()=>Object.keys(r),i.id=40118,e.exports=i},97890:()=>{},44370:()=>{},17657:()=>{},22972:()=>{},45467:()=>{},81754:()=>{},70347:()=>{},11452:()=>{},34946:()=>{},10497:()=>{},32857:()=>{},93818:()=>{},94498:()=>{},10108:()=>{},54476:()=>{},28992:()=>{},80897:()=>{},30187:()=>{},40837:()=>{},90479:()=>{},78752:()=>{},74282:()=>{},98379:()=>{},25238:()=>{},1508:()=>{},91993:()=>{},99624:()=>{},36974:()=>{},27479:()=>{},66822:()=>{},93661:()=>{},56024:()=>{},43390:()=>{},22143:()=>{},314:()=>{},49854:()=>{},40209:()=>{},87234:()=>{},38299:()=>{},72816:()=>{},11177:()=>{}}]);
//# sourceMappingURL=../sourcemaps/8.a6060785eaf41037f36400b171a8b865.js.map